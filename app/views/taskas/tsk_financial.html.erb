<!-- Project Card Example -->
<div class="row">
  <div class="col-lg-6">
    <div class="card shadow mb-4">
      <div class="card-header py-3">
        <h6 class="m-0 font-weight-bold text-primary">Financial Summary</h6>
      </div>
      <div class="card-body" style="margin-bottom: -20px ">

        <h4 class="small font-weight-bold" style="margin-bottom: 2px ">INCOMES (RM)  <span class="float-right">TOTAL: 47,320.00</span></h4>
        <div class="mb-4" style="height: 30px;">
          <div class="row" style="margin-left: 0.5px;margin-right: 0.5px;">
            <div class="progress-bar bg-secondary" role="progressbar" style="width: 60%;height: 30px; font-size:15px" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">42,325.0</div>
            <div class="progress-bar bg-success" role="progressbar" style="width: 40%;height: 30px; font-size:15px" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">42,325.0</div>
          </div>
          <div class="row" style="margin-left: 0.5px;margin-right: 0.5px;">
            <div class="font-weight-bold" style="width: 60%;height: 30px; font-size:11px; text-align: center">
              <i>Fees Collections</i>
            </div>
            <div class="font-weight-bold" style="width: 40%;height: 30px; font-size:11px; text-align: center">
              <i>Other Incomes</i>
            </div>
          </div>
        </div>

        <h4 class="small font-weight-bold" style="margin-bottom: 2px ">EXPENSES (RM)</h4>
        <div class="mb-4" style=""><div class="rows">
          <div class="progress-bar bg-danger" role="progressbar" style="width: 70%;height: 30px; font-size:15px" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">42,325.0</div>
        </div></div>

        <h4 class="small font-weight-bold" style="margin-bottom: 2px ">NETT (RM)</h4>
        <div class="mb-4" style=""><div class="rows">
          <div class="progress-bar bg-info" role="progressbar" style="width: 20%;height: 30px; font-size:15px" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">42,325.0</div>
        </div></div>
        
      </div>
    </div>

  </div> <!-- DIV COL-6 -->

  <div class="col-lg-6">
    <div class="row">

      <% if params[:sch_stt] == "Income" || params[:sch_stt].blank? %>
        <!-- Earnings (Monthly) Card Example -->
        <div class="col-md-6 mb-4">
          <div class="card border-left-success shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                  <div class="text-xs font-weight-bold text-success text-uppercase mb-1">No of Incomes</div>
                  <div class="h5 mb-0 font-weight-bold text-gray-800">20</div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-hand-holding-usd fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
      <% if params[:sch_stt] == "Expense" || params[:sch_stt].blank? %>
        <!-- Earnings (Monthly) Card Example -->
        <div class="col-md-6 mb-4">
          <div class="card border-left-danger shadow h-100 py-2">
            <div class="card-body">
              <div class="row no-gutters align-items-center">
                <div class="col mr-2">
                  <div class="text-xs font-weight-bold text-danger text-uppercase mb-1">NO OF EXPENSES</div>
                  <div class="h5 mb-0 font-weight-bold text-gray-800">5</div>
                </div>
                <div class="col-auto">
                  <i class="fas fa-file-invoice-dollar fa-2x text-gray-300"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
      


    </div> <!-- DIV ROW -->
    <a href="<%= "#{new_expense_url}?community_id=#{@taska.id}" %>" class="d-sm-inline-block btn btn-xl btn-primary shadow-sm"><i class="fas fa-plus fa-sm text-white-50"></i> Add New Item</a>

  </div> <!-- DIV COL -6 -->

</div><!-- DIV OVERALL ROW -->

<div class="card shadow mb-4">
  <div class="card-header">
    <div class="row">
      <%= form_tag tsk_financial_path, method: :get, id: "find_kid" do %>
      <% 
        yr_s = Date.today.year - 4
        yr_e = Date.today.year
      %>
        <%= select_tag :sch_yr, options_for_select(yr_s..yr_e, params[:sch_yr]) %>
        <%= select_tag :sch_mth, options_for_select(1..12, params[:sch_mth]), include_blank: "All Months" %>
        <%= select_tag :sch_stt, options_for_select(["Income","Expense"], params[:sch_stt]), include_blank: "All Types" %>
        
        <% text_field_tag :sch_str, params[:sch_str], placeholder: "Search Item" %>
        <% select_tag :sch_fld, options_for_select(["Unit No","Phone No","Name","Email","Bill ID"], params[:sch_fld]),
              include_blank: "Select Field" %>
        <%= hidden_field_tag :id, params[:id], value: params[:id] %>
        <%= hidden_field_tag :shw, params[:shw], value: true %>
        <%= button_tag(type: :submit, class: "badge badge-success shadow-none", style: "font-size: 14px; border-style: none; font-weight: normal", id: "submit_expense") do %>
            <i class="fa fa-search"></i> Search
        <% end %>
        <%= link_to tsk_financial_path(@taska, sch_yr: Date.today.year, sch_mth: Date.today.month), class: "badge badge-danger shadow-sm", style: "font-size: 14px; font-weight: normal" do %>
            <i class="fa fa-sync"></i> Clear
        <% end %>

        <% if params[:shw].blank? && 1==0 %>
          <%= link_to tsk_fee_path(@taska, sch_yr: Date.today.year, sch_mth: Date.today.month, shw: true), class: "badge badge-warning shadow-sm", style: "font-size: 14px; font-weight: normal" do %>
              <i class="fa fa-eye"></i> Show All
          <% end %>
        <% end %>

        <% if 1==0 && params[:shw].present? #params[:sch].present? %>
          <span class="badge badge-dark"><b><%= @payments.count %></b> result(s) found</span>
        <% end %>
      <% end %>
    </div>
  </div>
  <div class="card-body" style="font-size:15px">
    <div class="table-responsive border">
      <table class="table table-bordered table-striped shadow" id="dataTable" width="100%" cellspacing="0">

        <% if params[:sch_mth].present? || params[:sch_stt].present? %>

          <thead>
            <tr class="shadow">
              <th style="background-color:#ccccff">DATE</th>
              <th style="background-color:#ccccff">DESCRIPTION</th>
              <th style="background-color:#ccccff">INFLOW (RM)</th>
              <th style="background-color:#ccccff">OUTFLOW (RM)</th>
              <th style="background-color:#ccccff">DOCUMENT</th>
            </tr>
          </thead>
          <tbody>
            <% @exps.each do |exp| %>
              <tr>
                <td>
                  <%= exp.name %>
                  <%= link_to "Edit", edit_expense_path(exp) %>
                </td>
              </tr>
            <% end %>
          </tbody>

        <% elsif params[:sch_mth].blank? && params[:sch_stt].blank? %>

          <thead>
            <tr class="shadow">
              <th style="background-color:#ccccff">PERIOD</th>
              <th style="background-color:#ccccff">INCOME (RM)</th>
              <th style="background-color:#ccccff">EXPENSE (RM)</th>
              <th style="background-color:#ccccff">NETT (RM)</th>
            </tr>
          </thead>
          <tbody>
            <% @fin_arr.each do |inf| %>
              <tr>
                <td><%= "#{$month_name[inf[0]]}-#{inf[1]}"%></td>
                <td><%= inf[2] %></td>
                <td><%= inf[3] %></td>
                <%
                  clr = "#ffc966"
                  nett = inf[2] - inf[3]
                  if nett > 0
                    clr = "#7fbf7f"
                  elsif nett < 0
                     clr = "#ff9999"
                  end
                %>
                <td style="background-color: <%= clr %>"><%= nett %></td>
              </tr>
            <% end %>
          </tbody>

        <% end %>

      </table>
    </div>
  </div>
</div>


<script language="javascript" type="text/javascript">
  //setTimeout("location.reload();",2000);
</script>


